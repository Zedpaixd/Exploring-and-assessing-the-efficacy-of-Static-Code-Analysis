<?php
// Get user input
$username = $_GET['username'];
$script = $_GET['script'];

// Fetch user data from database
$db = new PDO('mysql:host=localhost;dbname=mydb', 'username', 'password');
$stmt = $db->prepare('SELECT * FROM users WHERE username = :username');
$stmt->bindParam(':username', $username);
$stmt->execute();
$user = $stmt->fetch(PDO::FETCH_ASSOC);

// Check if user exists
if (!$user) {
    echo "User not found.";
    exit;
}

// Parse user's stats
$stats = json_decode($user['stats'], true);

// Calculate total score
$total_score = 0;
foreach ($stats as $stat) {
    $total_score += $stat['score'];
}

// Evaluate user's custom script
eval($script);

echo "Total score for user $username is: $total_score";
?>